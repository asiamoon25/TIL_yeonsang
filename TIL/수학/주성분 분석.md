내가 선형대수학을 다시 할 줄은 몰랐는데... 예전 기억을 다시..

### 주성분 분석이란?
차원 축소에 사용되는 대표적인 알고리즘.

차원축소는 고차원 -> 저차원 으로 데이터를 옮기는 것을 말함.

**왜 필요할까**
 - 고차원으로 표현된 데이터는 계산 비용이 많고 분석에 필요한 시각화가 어렵기 때문
 - 꼬차원을 이루는 피처 중 상대적으로 중요도가 떨어지는 피처가 존재할 수 있기 때문
이러한 이유들로 중요도가 낮은 피처를 제외하는 대신 계산 비용이나 비교적 준수한 성능을 얻고,
이 두 개가 피처 표현력의 90% 를 띤다면 나머지 10%의 손실을 감수하더라고 계산 효율을 얻을 수 있게 된다.


주성분  분석을 통해 저차원 공간으로 변환 시 ==피처추출== 을 진행한다. 
➡️ 이는 기존 피처를 조합해 새로운 피처로 만드는 것을 의미한다.
이 때 피처와 기존 피처 간 연관성이 없어야 한다. 연관성이 없도록 직교 변환을 수행한다.

**직교변환**
	새로운 피처 공간과 기존 피처 공간이 90도를 이루게 된다. 즉 내적하면 0이 됨.
	기존 피처와 관련 없으면서 원 데이터의 표현력을 잘 보존해야함.
		잘 보존한다 ➡️ **분산** 을 최대로 하는 주축을 찾는다.
			_분산 : 데이터가 퍼진 정도를 의미_
		만약 4차원 공간이 있고 3차원 공간으로 축소한다면 3차원 공간상에서 데이터 분포가 넓게 퍼지는, 즉 분산을 가장 크게하는 벡터를 찾아야 한다.
	

![[Pasted image 20231229115745.png]]
![[Pasted image 20231229115825.png]]
그림으로 보면 위와 같이 분산이 커지는 축을 찾아서 차원 축소를 하게 된다.

2차원 공간을 1차원으로 줄일 때 2차원에 넓게 퍼진 데이터 분포를 1차원 상에서도 똑같이 넓게 퍼질 수 있도록 하는 '벡터' 를 찾아야함.

여기서 **벡터** 는 주축을 의미. ➡️ 주축과의 동의어를 **Eigen vector** 라고 한다.

주축을 찾고 주축에 피처들을 사상시키게 되면 주성분이 된다.
	다르게 말해서 피처들을 주축에 사상시킬 때 분산이 최대가 되는 주성분이 만들어진다.
	이렇게 분산이 가장 큰 주성분을 첫 번째 주성분, 두 번째로 큰 축을 두 번째 주성분이라고 한다.


**eigen vector 구하는 법, eigen vector 에 피처를 사상시키는 방법**
	Eigen vector 를 구하기 위해서는 특이값 분해 (SVD, singular Value Decomposition) 이 수행됨. 또 사상을 위해서 공분산 행렬이 필요하다.
	PCA 를 한마디로 말하면 데이터들의 공분산 행렬에 대한 특이값 분해(SVD) 로 볼 수 있음.

### 공분산 행렬

공분산은 한 마디로 두 피처가 함께 변하는 정도, 즉 공변하는 정도를 나타냄.
$$
\begin{align*}
	\sum = Cov(X) = \frac{X^TX}{n}
\end{align*}
$$
n은 행렬 X에 있는 데이터 샘플 개수를 나타냄. X 란 전체 피처와 데이터 값을 나타냄.
X의 열축은 피처가 되고 X의 행축은 데이터 개수가 됨.

ex) $x_1, x_2, x_3$ 피처 3개가 있다고 가정하면 $X^T \times T$ 는 다음과 같이 표현할 수 있음.
$$
\begin{align*}
 X^T \times X = 
\begin{pmatrix}
0.1 & 0.4 & 0.7\\
0.2&0.5&0.8\\
0.3&0.6&0.9
\end{pmatrix}
\times 
\begin{pmatrix}
0.1&0.2&0.3\\
0.4&0.5&0.6\\
0.7&0.8&0.9
\end{pmatrix}
\end{align*}
$$
