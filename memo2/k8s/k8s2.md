# PODS

### 파드(Pods)

- **기본 단위**: 파드는 쿠버네티스에서 애플리케이션을 실행하는 가장 작은 단위. 하나의 파드는 하나 이상의 컨테이너를 포함할 수 있으며, 이 컨테이너들은 스토리지, 네트워크를 공유하고, 어떻게 실행될지에 대한 설정을 함께 가진다.
- **컨테이너 묶음**: 일반적으로, 파드는 서로 밀접하게 연관된 기능을 수행하는 컨테이너를 묶어서 관리한다. 예를 들어, 메인 애플리케이션 컨테이너와 로그 수집, 모니터링을 위한 사이드카(sidecar) 컨테이너가 함께 파드를 구성할 수 있다.
- **생명주기**: 파드는 일시적인(ephemeral) 리소스. 파드가 실행되는 노드에 장애가 발생하면, 해당 파드는 손실되고, 레플리카셋(ReplicaSet)이나 디플로이먼트(Deployment)에 의해 다른 노드에 새로운 파드가 생성된다.

# SERVICE
### 서비스(Services)

- **네트워크 추상화**: 서비스는 하나 이상의 파드에 대한 안정적인 네트워크 주소를 제공하는 쿠버네티스 리소스. 서비스를 통해 파드 그룹에 접근할 때 사용하는 IP 주소와 포트는 파드가 재생성되어 IP가 변경되더라도 변하지 않는다.
- **로드 밸런싱**: 서비스는 파드 그룹에 대한 네트워크 트래픽을 자동으로 분산시키는 기능을 한다. 클라이언트는 서비스를 통해 파드 그룹에 요청을 보내면, 서비스는 이 요청을 파드들 사이에 로드 밸런싱한다.
- **서비스 타입**: 쿠버네티스는 여러 종류의 서비스를 제공한다. 예를 들어, `ClusterIP` 서비스는 클러스터 내부에서만 접근 가능한 내부 IP를 제공하고, `NodePort`와 `LoadBalancer` 서비스는 클러스터 외부에서 파드 그룹에 접근할 수 있게 한다.







_PODS 와 SERVICE 는 서로 독립적인 관계
SERVICE 는 PODS들에 대한 네트워크 접근을 제공하는 추상적인 레이어로써 작동함._


_SERVICE 는 같은 IP 대역대로 묶어서 각 PODS들 끼리의 통신이 가능하게 하는거라고 이해하면됨._ ⬇️
### 서비스를 통한 파드 간 통신

- **내부 통신**: 쿠버네티스 클러스터 내부에서, 서비스는 파드들 사이의 내부 통신을 위한 안정적인 방법을 제공한다. 서비스는 특정 포트를 통해 트래픽을 받아, 선택된 파드들 중 하나로 트래픽을 전달한다. 이 과정은 로드 밸런싱을 자동으로 처리한다.
    
- **동일 대역대 통신**: 쿠버네티스 클러스터는 내부적으로 파드와 서비스에 대해 별도의 IP 주소 대역을 할당한다. 클러스터 내의 모든 컴포넌트는 이 내부 네트워크를 통해 서로 통신할 수 있으며, 서비스를 통해 파드들 간의 통신도 이 대역대 내에서 이루어진다.
    

### 서비스의 역할

- **접근 지점 제공**: 서비스는 파드 그룹에 대한 접근 지점 역할을 하여, 파드들이 삭제되거나 새로 생성될 때 IP 주소가 변경되더라도 일관된 접근 방법을 제공한다.
    
- **로드 밸런싱**: 서비스는 네트워크 트래픽을 파드들 사이에 분산시키는 역할을 한다. 이는 파드들의 부하를 균등하게 분배하여, 애플리케이션의 가용성과 확장성을 향상시킨다.
    
- **추상화 및 간소화**: 서비스를 사용함으로써, 파드의 실제 네트워크 주소를 알 필요 없이 파드 그룹에 접근할 수 있다. 이는 애플리케이션 구성을 단순화하고, 클러스터 내에서 서비스 간의 통신을 쉽게 구성할 수 있게 한다.





Cluster -> Pods 이렇게 있는데 Cluster 끼리도 Service 로 묶일 수 있나?
➡️ ㄴㄴ, service 는 Pods 들의 통신만, 클러스터끼리는 로드밸런싱 직접적인 통신? 은 안됨.



여기서 생기는 궁금증
1. Cluster 는 동일하게 만들어서 로드밸런싱을 해서 부하를 줄이는 방법이 적절한 사용방법인지 아니면 원래 그렇게 하는건지 
2. 한 클러스터 내에서는 Service 가 많이 존재해야하는건지 
3. service 는 VPC 개념으로 이해하면 되는지




#### 1. 클러스터 로드밸런싱과 부하 분산
로드밸런싱으로 부하 분산 하는거 맞음.

#### 2. 서비스 역할과 필요성
서비스는 Pods 들의 집합에 대한 안정적인 접근 방법을 제공함. 로드밸런싱, 이름을 통한 서비스 디스커버리 등의 기능을함.

#### 3. VPC 와의 차이점.
- **서비스와 VPC의 차이**: 서비스는 쿠버네티스 내부에서 파드들의 논리적인 집합에 대한 네트워크 접근을 관리하는 오브젝트. 반면, VPC(가상 사설 클라우드)는 클라우드 환경에서 사용자가 정의할 수 있는 격리된 네트워크 세그먼트로, 보다 광범위한 네트워크 관리와 구성을 가능하게 한다.
- **개념적 차이**: VPC는 네트워크의 물리적 구조와 보안을 추상화하는 클라우드 인프라 수준의 개념이며, 서비스는 쿠버네티스 애플리케이션 수준에서의 네트워크 추상화를 제공한다. 즉, 서비스는 VPC 내에서 작동하는 애플리케이션 구성 요소를 논리적으로 묶는 역할을 하며, VPC는 그러한 서비스들이 작동하는 더 넓은 네트워크 환경을 제공한다.

➡️ 인프라 수준이냐 애플리케이션 수준이냐 이 차이인듯..


#### 4. 클러스터는 VM 하고 비슷함?
동일하게 보기에는 한계가 있음.

* 쿠버네티스 클러스터
	* 추상화 수준 : 컨테이너화 된 애플리케이션을 관리하기 위한 추상화를 제공함. 클러스터는 여러 노드로 구성되며, 이 노드들 위에서 컨테이너화된 애플리케이션(PODS)이 실행됨..
	* 왜?(목적): 쿠버네티스는 애플리케이션의 배포, 확장 및 관리를 자동화하는 것을 목표로 한다. 클러스터는 애플리케이션의 실행을 위한 리소스(컴퓨팅, 스토리지, 네트워크)를 효율적으로 분배하고, 실패한 컴포넌트를 자동으로 복구하는 등의 기능을 제공함.
* VM
	* 부하 대응 : 기존 VM 시스템에서는 바하가 증가할 때 추가 VM 인스턴스를 생성하고, 거기에 소프트웨어를 배포하여 부하를 분산시킬 수 있음. 이는 스케일 아웃 방식이여서 필요에 따라 리소스를 동적으로 확장할 수 있게 해줌.
	* 쿠버네티스의 접근 방식 : 쿠버네티스에서는 파드의 수를 늘리거나 줄여서(수평확장의 개념임ㅇㅇ) 부하에 대응함... 쿠버네티스는 이러한 스케일링을 자동으로 관리할 수 있고, 애플리케이션의 상태를 모니터링 하고 필요에 따라 파드를 추가하거나 삭제함.

K8s 는 위ㅣ대하다....그닥...


결론은 <span style="background-color:#F5F5F5">
<span style="color:black">쿠버네티스 클러스터와 VM은 서로 다른 추상화 수준과 목적을 가지고 있다</span>
</span>





CLIENT VALUES:
client_address=192.168.65.3
command=GET
real path=/
query=nil
request_version=1.1
request_uri=http://localhost:8080/

SERVER VALUES:
server_version=nginx: 1.10.0 - lua: 10001

HEADERS RECEIVED:
accept=text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
accept-encoding=gzip, deflate, br, zstd
accept-language=ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7,ja;q=0.6
connection=keep-alive
host=localhost:30271
sec-ch-ua="Chromium";v="122", "Not(A:Brand";v="24", "Google Chrome";v="122"
sec-ch-ua-mobile=?0
sec-ch-ua-platform="Windows"
sec-fetch-dest=document
sec-fetch-mode=navigate
sec-fetch-site=none
sec-fetch-user=?1
upgrade-insecure-requests=1
user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36
BODY:
-no body in request-